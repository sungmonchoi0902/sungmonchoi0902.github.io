<!doctype html>
<html lang="en">
<header>
<meta charset="UTF-8">
<title>tabby cat</title>
<link href="styles.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/p5.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/addons/p5.sound.min.js"></script>
</header>
<body>
<h1>
good afternoon, 261!
</h1>
<p>
  <h2>yooooooooooo</h2>
  <hr />
  <div>
  <blockquote><b><i><u> "meoooooooow" </u></i></b></blockquote>
</div>
  <br>
  <div>
  <a href="http://racheldevorah.studio"> my real website </a>
  </div>
   <br>
  <div>
  <img src="oprah.gif">
</div>
    <div>
<ul>
		<li>corn</li>
		<li>squash</li>
		<li>beans</li>
</ul>
</div>
<br>
<div>
  <audio controls> <source src="mtec343.mp3" type="audio/mpeg"></audio> 
  <br>
</div>
<div>
	    <script src="orbits.js"></script>
</div>
</p>

<!-- ğŸ”¥ ì—¬ê¸°ì— ë„¤ p5.js ì½”ë“œ ì¶”ê°€ë¨ -->
<script>
let cam;
let mic;
let smoothVol = 0;

// ë°°ê²½ ì˜¤ì‹¤ë ˆì´í„°
let bgOsc1, bgOsc2, bgOsc3;

// ì‚ ì†Œë¦¬ ì˜¤ì‹¤ë ˆì´í„°
let beepOsc;
let isBeepOn = false;
let isBgOn = true;

function setup() {
  createCanvas(640, 480);
  pixelDensity(1);

  cam = createCapture(VIDEO);
  cam.size(320, 240);
  cam.hide();

  mic = new p5.AudioIn();
  mic.start();

  noStroke();
  rectMode(CORNER);
  frameRate(30);

  // ë°°ê²½ ì˜¤ì‹¤ë ˆì´í„°
  bgOsc1 = new p5.Oscillator('sine');
  bgOsc2 = new p5.Oscillator('sine');
  bgOsc3 = new p5.Oscillator('sine');

  bgOsc1.freq(midiToFreq(48)); // C3
  bgOsc2.freq(midiToFreq(62)); // D4
  bgOsc3.freq(midiToFreq(71)); // B4

  bgOsc1.amp(0.03);
  bgOsc2.amp(0.025);
  bgOsc3.amp(0.02);

  bgOsc1.start();
  bgOsc2.start();
  bgOsc3.start();

  // ì‚ ì†Œë¦¬
  beepOsc = new p5.Oscillator('sine');
  beepOsc.freq(880); 
  beepOsc.amp(0);
  beepOsc.start();
}

function draw() {
  background(0);

  let vol = mic.getLevel();
  smoothVol = lerp(smoothVol, vol, 0.1);

  let mosaicSize = int(map(smoothVol, 0, 0.05, 60, 1, true));

  cam.loadPixels();
  if (cam.pixels.length === 0) return;

  push();
  translate(width, 0);
  scale(-1, 1);

  if (mosaicSize > 2) {
    // ëª¨ìì´í¬
    for (let y = 0; y < cam.height; y += mosaicSize) {
      for (let x = 0; x < cam.width; x += mosaicSize) {
        let i = (y * cam.width + x) * 4;
        let r = cam.pixels[i];
        let g = cam.pixels[i + 1];
        let b = cam.pixels[i + 2];
        fill(r, g, b);
        rect(x * 2, y * 2, mosaicSize * 2, mosaicSize * 2);
      }
    }

    if (isBeepOn) {
      beepOsc.amp(0, 0.3);
      isBeepOn = false;
    }
    if (!isBgOn) {
      bgOsc1.amp(0.03, 0.5);
      bgOsc2.amp(0.025, 0.5);
      bgOsc3.amp(0.02, 0.5);
      isBgOn = true;
    }

  } else {
    image(cam, 0, 0, width, height);

    if (!isBeepOn) {
      beepOsc.amp(0.2, 0.2);
      isBeepOn = true;
    }
    if (isBgOn) {
      bgOsc1.amp(0, 0.5);
      bgOsc2.amp(0, 0.5);
      bgOsc3.amp(0, 0.5);
      isBgOn = false;
    }
  }

  pop();
}

function mousePressed() {
  userStartAudio();
}
</script>

</body>
</html>